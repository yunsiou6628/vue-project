import{a5 as v,a as w,l as C,o as u,a6 as d,b as e,w as r,V as x,a7 as b,S as q,d as h,g as t,P as B,a8 as S,a9 as c,X as f,f as i,h as n,aa as N,ab as $}from"./index.01c9f2a1.js";import{V}from"./VDivider.345092ba.js";import{V as D}from"./VTable.5c39b414.js";const P={id:"cart"},T=t("h1",{class:"text-center"},"\u8CFC\u7269\u8ECA",-1),z=t("thead",null,[t("tr",null,[t("th",null,"\u5716\u7247"),t("th",null,"\u540D\u7A31"),t("th",null,"\u55AE\u50F9"),t("th",null,"\u6578\u91CF"),t("th",null,"\u5C0F\u8A08"),t("th",null,"\u64CD\u4F5C")])],-1),A=n("-"),E=n("+"),F=n("\u522A\u9664"),I={key:1},L=t("td",{colspan:"6"},[t("h3",{class:"text-center"},"\u6C92\u6709\u5546\u54C1")],-1),R=[L],U=n("\u7D50\u5E33"),K={__name:"CartView",setup(X){const k=v(),l=w([]),m=C(()=>l.reduce((a,o)=>a+o.product.price*o.quantity,0)),g=C(()=>l.length>0&&!l.some(a=>!a.product.sell)),_=async(a,o)=>{await k.updateCart({product:l[a].product._id,quantity:o})&&(o===0?l.splice(a,1):l[a].quantity=o)};return(async()=>{try{const{data:a}=await b.get("/users/cart");l.push(...a.result)}catch{q.fire({icon:"error",title:"\u5931\u6557",text:"\u4F3A\u670D\u5668\u932F\u8AA4"})}})(),(a,o)=>(u(),d("div",P,[e(x,null,{default:r(()=>[e(h,{cols:"12"},{default:r(()=>[T]),_:1}),e(V),e(h,{cols:"12"},{default:r(()=>[e(D,null,{default:r(()=>[z,t("tbody",null,[l.length>0?(u(!0),d(B,{key:0},S(l,(s,p)=>(u(),d("tr",{key:s._id,class:N({"bg-red":!s.product.sell})},[t("td",null,[e($,{src:s.product.image},null,8,["src"])]),t("td",null,c(s.product.name),1),t("td",null,c(s.product.price),1),t("td",null,[e(i,{color:"primary",onClick:y=>_(p,s.quantity-1),variant:"text"},{default:r(()=>[A]),_:2},1032,["onClick"]),n(c(s.quantity),1),e(i,{color:"primary",onClick:y=>_(p,s.quantity+1),variant:"text"},{default:r(()=>[E]),_:2},1032,["onClick"])]),t("td",null,c(s.product.price*s.quantity),1),t("td",null,[e(i,{color:"primary",onClick:y=>_(p,0)},{default:r(()=>[F]),_:2},1032,["onClick"])])],2))),128)):(u(),d("tr",I,R))])]),_:1})]),_:1}),e(V),e(h,{class:"text-center",cols:"12"},{default:r(()=>[t("p",null,"\u7E3D\u91D1\u984D "+c(f(m)),1),e(i,{class:"mx-auto",color:"success",onClick:f(k).checkout,disabled:!f(g)},{default:r(()=>[U]),_:1},8,["onClick","disabled"])]),_:1})]),_:1})]))}};export{K as default};
